name = "Use correct process templates"
description = "enforce"


scope {
    rego = <<-EOT
        package securitychecks 
        default evaluate := false
        evaluate := true if {
            input.Environment.Name == "Development"
            input.Project.Name == "Invoicer"
        }
    EOT
}


conditions {
    rego = <<-EOT
        package securitychecks
        default result := {"allowed": false}
        result := {"allowed": true} if {
            some step in input.Steps
             step.Source.Type == "Process Template"
        }
    EOT
}
